<div class="content-header">
  <h1>Mes candidatures</h1>
</div>

<div class="content-body">
  <!-- Actions -->
  <div style="margin-bottom: 20px;">
    <button class="btn btn-primary">+ Nouvelle candidature</button>
    <a routerLink="/dashboard" class="btn" style="margin-left: 10px; background-color: #6c757d; color: white;">
      ← Retour au tableau de bord
    </a>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error">
    {{ error }}
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && !error && jobApplications.length === 0" class="card">
    <div class="card-body" style="text-align: center; padding: 60px 20px;">
      <h3 style="color: #6c757d; margin-bottom: 20px;">Aucune candidature trouvée</h3>
      <p style="color: #6c757d; margin-bottom: 30px;">Commencez par ajouter votre première candidature</p>
      <button class="btn btn-primary">+ Ajouter une candidature</button>
    </div>
  </div>

  <!-- Job Applications Table -->
  <div *ngIf="!loading && !error && jobApplications.length > 0" class="table-container">
    <table class="table">
      <thead>
        <tr>
          <th>Poste</th>
          <th>Entreprise</th>
          <th>Statut</th>
          <th>Date de candidature</th>
          <th>Dernière mise à jour</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let application of jobApplications">
          <td>
            <strong>{{ application.job_offer?.title || 'N/A' }}</strong>
            <div *ngIf="application.job_offer?.location" style="font-size: 12px; color: #6c757d;">
              📍 {{ application.job_offer.location }}
            </div>
          </td>
          <td>
            <div>{{ application.company?.name || 'N/A' }}</div>
            <div *ngIf="application.company?.website" style="font-size: 12px;">
              <a [href]="application.company.website" target="_blank" style="color: #2196F3;">
                🌐 Site web
              </a>
            </div>
          </td>
          <td>
            <span [class]="getStatusBadgeClass(application.status)">
              {{ application.status }}
            </span>
          </td>
          <td>{{ formatDate(application.created_at) }}</td>
          <td>{{ formatDate(application.updated_at) }}</td>
          <td>
            <div style="display: flex; gap: 8px;">
              <button class="btn btn-sm" style="background-color: #17a2b8; color: white; padding: 6px 12px; font-size: 12px;">
                👁️ Voir
              </button>
              <button class="btn btn-sm" style="background-color: #ffc107; color: black; padding: 6px 12px; font-size: 12px;">
                ✏️ Modifier
              </button>
              <button 
                class="btn btn-sm" 
                style="background-color: #dc3545; color: white; padding: 6px 12px; font-size: 12px;"
                (click)="deleteApplication(application.id)">
                🗑️ Supprimer
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Summary -->
  <div *ngIf="!loading && !error && jobApplications.length > 0" class="card" style="margin-top: 30px;">
    <div class="card-body">
      <h4 style="margin-bottom: 15px;">Résumé</h4>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px;">
        <div style="text-align: center;">
          <div style="font-size: 24px; font-weight: 700; color: #2196F3;">{{ jobApplications.length }}</div>
          <div style="font-size: 14px; color: #6c757d;">Total</div>
        </div>
        <div style="text-align: center;">
          <div style="font-size: 24px; font-weight: 700; color: #4CAF50;">
            {{ (jobApplications | filter: {status: 'applied'}).length }}
          </div>
          <div style="font-size: 14px; color: #6c757d;">Candidatures envoyées</div>
        </div>
        <div style="text-align: center;">
          <div style="font-size: 24px; font-weight: 700; color: #FF9800;">
            {{ (jobApplications | filter: {status: 'interview'}).length }}
          </div>
          <div style="font-size: 14px; color: #6c757d;">Entretiens</div>
        </div>
        <div style="text-align: center;">
          <div style="font-size: 24px; font-weight: 700; color: #9C27B0;">
            {{ (jobApplications | filter: {status: 'accepted'}).length }}
          </div>
          <div style="font-size: 14px; color: #6c757d;">Acceptées</div>
        </div>
      </div>
    </div>
  </div>
</div>
